# 📂 VBA File Rename Tool

### **소개**
이 Excel VBA 매크로는 선택한 폴더 및 하위 폴더 내 파일명을 관리하고, 특정 규칙에 따라 파일명을 변경하는 기능을 제공합니다. 파일 목록을 자동으로 수집하고, 조건에 맞는 파일명을 새롭게 지정하며, 파일명을 변경하는 작업을 자동화합니다.

---

## **기능**
1. **폴더 선택**  
   사용자가 폴더를 선택하면 해당 폴더 및 하위 폴더의 파일 목록을 가져옵니다.

2. **파일 목록 작성**  
   선택한 폴더의 파일 목록을 Excel의 **Tool 시트**에 출력합니다.

3. **파일명 변경**  
   Tool 시트에 작성된 파일명 규칙에 따라 파일명을 변경합니다.

4. **중복 파일명 감지**  
   변경하려는 파일명이 이미 폴더 내에 존재하는 경우, 경고 메시지를 표시합니다.

5. **결과 메시지 및 탐색기 열기**  
   파일명 변경이 완료되면 메시지를 출력하고 탐색기를 자동으로 엽니다.

---

## **사용 방법**
1. **Tool 시트 준비**  
   Excel 내 `Tool` 시트를 생성하고, 기존 파일명(M 열) 및 새로운 파일명(N 열)을 작성할 수 있도록 준비합니다.

2. **매크로 실행**  
   `FList_MST_toChangeNm()` 서브루틴을 실행하여 폴더 선택 창을 엽니다.

3. **파일 목록 생성**  
   선택한 폴더와 하위 폴더의 파일 목록이 Tool 시트에 출력됩니다.

4. **파일명 변경**  
   Tool 시트의 `M 열(기존 파일명)`과 `N 열(새 파일명)`의 규칙에 따라 파일명을 변경합니다.

---

## **코드 설명**
- **`FList_MST_toChangeNm()`**  
  파일 목록을 가져오고, 선택된 폴더의 하위 폴더를 탐색합니다.

- **`Folder_List_toChangeNm()`**  
  하위 폴더를 재귀적으로 탐색하며 모든 폴더의 파일 정보를 수집합니다.

- **`File_List_toChangeNm()`**  
  각 폴더의 파일 목록을 Tool 시트에 출력합니다.  
  숨김 파일, 시스템 파일 등은 제외됩니다.

- **`Rename_files()`**  
  Tool 시트의 규칙에 따라 파일명을 변경합니다.

- **`OpenExplorer()`**  
  파일명 변경 작업이 완료된 폴더를 탐색기에서 엽니다.

- **`ClearContents()`**  
  이전에 작성된 파일 목록 데이터를 초기화합니다.

- **`AlertMessage()`**  
  오류나 경고 상황에서 사용자에게 메시지를 출력합니다.

---

## **주의 사항**
1. **Tool 시트 작성 규칙**  
   - `M 열`에 기존 파일명, `N 열`에 새로운 파일명을 작성합니다.  
     예:  
     | M 열 (기존 파일명) | N 열 (새 파일명) |
     |-------------------|-----------------|
     | example1.jpg      | new_example1.jpg |

2. **중복 파일명 확인**  
   동일한 이름의 파일이 이미 존재하는 경우, 파일명이 변경되지 않습니다.

3. **파일 속성 제한**  
   숨김(Hidden), 시스템(System), 아카이브(Archive) 속성의 파일은 변경되지 않습니다.

---

📌 **이 매크로는 오프라인 환경에서 파일 관리 및 이름 변경 작업을 효율적으로 자동화할 수 있도록 설계되었습니다. 사용 전 Tool 시트를 정확히 설정하고 백업을 권장합니다.**
