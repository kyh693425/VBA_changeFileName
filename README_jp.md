📂 ファイル名変更ツール VBAマクロスクリプト

1. 概要

このExcel VBAマクロは、選択したフォルダとそのサブフォルダ内のファイル名を管理し、
特定のルールに従ってファイル名を変更する機能を提供します。このスクリプトは、ファイルリストを取得し、
条件に基づいて新しい名前を割り当て、ファイル名を変更するプロセスを自動化します。

-----

2. 主な機能

	1.	フォルダ選択
ユーザーがフォルダを選択すると、そのフォルダおよびサブフォルダ内のファイルリストを取得します。
	2.	ファイルリスト作成
指定されたシート（Tool）にファイルリストを記録します。
	3.	ファイル名変更
シートで指定されたファイル名ルールに基づいてファイル名を変更します。
	4.	重複ファイル名検出
変更後のファイル名が既に存在する場合、警告メッセージを表示します。
	5.	結果メッセージとエクスプローラーを開く
ファイル名変更完了後にメッセージを出力し、エクスプローラーを自動的に開きます。

-----

3. 使用方法

	1.	Excelファイル内のToolシートを準備します。
	2.	マクロ実行:
	•	FList_MST_toChangeNm()サブルーチンを実行すると、フォルダ選択画面が開きます。
	3.	ファイルリスト作成:
	•	選択したフォルダおよびサブフォルダ内のファイルリストがToolシートに出力されます。
	4.	ファイル名変更:
	•	ToolシートのM列（元のファイル名）とN列（新しいファイル名）を比較し、ファイル名を変更します。

-----

4. コード説明

	•	FList_MST_toChangeNm()
ファイルリストとフォルダ情報を取得し、サブフォルダを検索します。
	•	Folder_List_toChangeNm()
サブフォルダを再帰的に検索して、すべてのフォルダ内のファイル情報を収集します。
	•	File_List_toChangeNm()
各フォルダのファイルリストを取得し、Toolシートに出力します。隠しファイルやシステムファイルは除外されます。
	•	Rename_files()
Toolシートに記載されたルールに基づいてファイル名を変更します。
	•	OpenExplorer()
作業完了後にエクスプローラーを開いて、変更されたファイルを確認します。
	•	ClearContents()
以前のファイルリストデータを初期化します。
	•	AlertMessage()
エラーや警告時にメッセージを表示します。

-----

5. 注意事項

	•	Toolシートの**M列（元のファイル名）およびN列（新しいファイル名）**に正しいファイル名ルールを記載する必要があります。
	•	同じ名前のファイルが存在する場合、ファイル名は変更されません。
	•	隠し属性、システム属性、アーカイブ属性のファイルは変更されません。
