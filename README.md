# 📂 ファイル名変更ツール VBAマクロスクリプト

## **1. 概要**
このExcel VBAマクロは、選択したフォルダとそのサブフォルダ内のファイル名を管理し、特定のルールに従ってファイル名を変更する機能を提供します。  
ファイルリストを取得し、条件に基づいて新しい名前を割り当て、ファイル名を変更するプロセスを自動化します。

---

## **2. 主な機能**
### **1. フォルダ選択**
ユーザーがフォルダを選択すると、そのフォルダおよびサブフォルダ内のファイルリストを取得します。

### **2. ファイルリスト作成**
指定されたシート（`Tool`）にファイルリストを記録します。

### **3. ファイル名変更**
シートで指定されたファイル名ルールに基づいてファイル名を変更します。

### **4. 重複ファイル名検出**
変更後のファイル名が既に存在する場合、警告メッセージを表示します。

### **5. 結果メッセージとエクスプローラーを開く**
ファイル名変更が完了すると、メッセージを出力し、エクスプローラーを自動的に開きます。

---

## **3. 使用方法**
1. **`Tool`シートを準備**  
   - Excelファイル内に`Tool`シートを作成します。
   - `M列`（元のファイル名）と`N列`（新しいファイル名）の形式で記入します。

2. **マクロ実行**  
   - `FList_MST_toChangeNm()`サブルーチンを実行すると、フォルダ選択画面が開きます。

3. **ファイルリスト作成**  
   - 選択したフォルダおよびサブフォルダ内のファイルリストが`Tool`シートに出力されます。

4. **ファイル名変更**  
   - `M列`（元のファイル名）と`N列`（新しいファイル名）を比較し、条件に基づいてファイル名を変更します。

---

## **4. コード説明**
- **`FList_MST_toChangeNm()`**  
  ファイルリストとフォルダ情報を取得し、サブフォルダを検索します。

- **`Folder_List_toChangeNm()`**  
  サブフォルダを再帰的に検索し、すべてのフォルダ内のファイル情報を収集します。

- **`File_List_toChangeNm()`**  
  各フォルダのファイルリストを取得し、`Tool`シートに出力します。隠しファイルやシステムファイルは除外されます。

- **`Rename_files()`**  
  `Tool`シートに記載されたルールに基づいてファイル名を変更します。

- **`OpenExplorer()`**  
  ファイル名変更作業が完了した後、エクスプローラーを開いて変更内容を確認します。

- **`ClearContents()`**  
  以前に作成されたファイルリストデータを初期化します。

- **`AlertMessage()`**  
  エラーや警告状況でメッセージを表示します。

---

## **5. 注意事項**
1. **Toolシートの作成規則**  
   - `M列`（元のファイル名）と`N列`（新しいファイル名）を正確に記入してください。  
     例:  
     | M列（元のファイル名） | N列（新しいファイル名） |
     |--------------------|--------------------|
     | example1.jpg      | new_example1.jpg  |

2. **重複ファイル名の検出**  
   - 同じ名前のファイルが既に存在する場合、ファイル名は変更されません。

3. **ファイル属性の制限**  
   - 隠しファイル、システムファイル、アーカイブファイルは変更対象外です。

---

📌 **正確なファイルリストの記載を心がけ、バックアップを取ってから実行することをお勧めします。**
